<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8">
<title>ESP32 MIDI ‚Üí Multi Solenoids</title>

<style>
:root{
  --bg1:#ffd27d;   /* v√†ng cam nh·∫°t (tr√™n) */
  --bg2:#ff9f1c;   /* cam trung */
  --bg3:#ff6f00;   /* cam ƒë·∫≠m (d∆∞·ªõi) */

  --card:#ffffffee;
  --accent:#ff6f00;
  --accent2:#ff9100;
  --danger:#e53935;
  --violet:#ab47bc;
  --brown:#8d6e63;
}

/* ====== GLOBAL ====== */
body{
  font-family:"Segoe UI", Arial, sans-serif;
  max-width:960px;
  margin:0 auto;
  padding:24px;
  color:#3a2a00;

  background:
    radial-gradient(circle at 20% 10%, #ffffff66 0%, transparent 35%),
    radial-gradient(circle at 80% 20%, #fff3 0%, transparent 40%),
    linear-gradient(
      120deg,
      var(--bg1),
      var(--bg2),
      var(--bg3),
      var(--bg2)
    );

  background-size:200% 200%;
  animation:bgMove 18s ease-in-out infinite;
}


/* ====== LOGO G√ìC TR√ÅI ====== */
body::before{
  content:"";
  position:fixed;
  top:16px;
  left:16px;

  width:80px;
  height:80px;

  background-image:url('./Logo-FPT.webp');
  background-size:contain;
  background-repeat:no-repeat;
  background-position:center;

  opacity:0.9;
  z-index:999;
  pointer-events:none;
}

/* ====== HEADER ====== */
.header{
  display:flex;
  align-items:center;
  justify-content:center;
  gap:18px;
  margin-bottom:12px;
}
.header img{
  height:64px;
  background:#fff;
  padding:8px 12px;
  border-radius:14px;
  box-shadow:0 6px 18px rgba(0,0,0,.35);
}
.header h2{
  margin:0;
  color:#fff;
  letter-spacing:1px;
  white-space:nowrap;
}

/* ====== TICKER ====== */
.ticker{
  overflow:hidden;
  white-space:nowrap;
  background:linear-gradient(
    90deg,
    #00000055,
    #00000033,
    #00000055
  );
  border-radius:999px;
  padding:10px 0;
  margin:12px 0 28px;
  box-shadow:
    inset 0 0 14px rgba(0,0,0,.4),
    0 4px 12px rgba(0,0,0,.25);
}

.ticker span{
  display:inline-block;
  padding-left:100%;
  animation:ticker 18s linear infinite;
  font-size:18px;
}
@keyframes bgMove{
  0%   { background-position:0% 50%; }
  50%  { background-position:100% 50%; }
  100% { background-position:0% 50%; }
}
@keyframes ticker{
  from { transform: translateX(0); }
  to   { transform: translateX(-100%); }
}


/* ====== CARD ====== */
.card{
  background:rgba(255,255,255,0.88);
  border-radius:16px;
  box-shadow:
    0 10px 30px rgba(0,0,0,.18),
    inset 0 1px 0 rgba(255,255,255,.6);
  padding:18px;
  margin:18px 0;
  backdrop-filter: blur(8px);
}
h3{
  margin-top:0;
  border-left:6px solid var(--accent2);
  padding-left:10px;
}

/* ====== BUTTONS ====== */
button{
  padding:10px 18px;
  border:0;
  border-radius:999px;
  margin:6px;
  cursor:pointer;
  font-weight:600;
  box-shadow:0 4px 10px rgba(0,0,0,.25);
  transition:.15s;
}
button:hover{transform:translateY(-1px);}
button:active{transform:scale(.97);}

.play{background:var(--accent);color:#fff}
.stop{background:var(--danger);color:#fff}
.upload{background:var(--accent2);color:#fff}
.tool{background:var(--brown);color:#fff}
.test{background:var(--violet);color:#fff}
.btn{min-width:64px}

/* ====== TEXT ====== */
.small{font-size:12px;color:#555;}
code{
  background:#00000010;
  padding:2px 8px;
  border-radius:999px;
}

/* ====== INPUT ====== */
input[type=range]{width:260px;}
.value{
  display:inline-block;
  min-width:52px;
  text-align:center;
  font-weight:700;
}

/* ====== TABLE ====== */
table{
  border-collapse:collapse;
  width:100%;
}
th,td{
  border:1px solid #e0e0e0;
  padding:8px;
}
th{background:#f4f4f4;}
.tag{
  display:inline-block;
  padding:3px 10px;
  border-radius:999px;
  background:#e0e0e0;
  margin:2px 4px;
  font-size:12px;
}
</style>
</head>

<body>

<div class="header">
  <h2>ESP32 MIDI ‚Üí Multi-Solenoids</h2>
</div>

<div class="ticker">
  <span>
  üéì FPT UNIVERSITY CH√ÄO M·ª™NG C√ÅC B·∫†N ƒê·∫æN V·ªöI NG√ÄY H·ªòI OPEN DAY ‚Ä¢ 
  üéì FPT UNIVERSITY CH√ÄO M·ª™NG C√ÅC B·∫†N ƒê·∫æN V·ªöI NG√ÄY H·ªòI OPEN DAY ‚Ä¢ 
  üéì FPT UNIVERSITY CH√ÄO M·ª™NG C√ÅC B·∫†N ƒê·∫æN V·ªöI NG√ÄY H·ªòI OPEN DAY
  </span>
</div>

<div class="card">
  <h3>Upload MIDI</h3>
  <form method="POST" action="/upload" enctype="multipart/form-data">
    <input type="file" name="midi" accept=".mid,.midi" required>
    <button class="upload" type="submit">Upload ‚Üí <code>/song.mid</code></button>
  </form>
</div>

<div class="card">
  <h3>Playback Control</h3>
  <button class="play" onclick="fetch('/play')">‚ñ∂ Play</button>
  <button class="tool" onclick="fetch('/scan')">Scan Notes</button>
  <button class="stop" onclick="fetch('/stop')">‚ñ† Stop</button>
</div>

<div class="card">
  <h3>Power ‚Äì L·ª±c g√µ tr·ªëng</h3>
  <input id="pwr" type="range" min="0.5" max="3.0" step="0.1" value="1.0"
    oninput="pwrval.textContent=this.value"
    onchange="setPower(this.value)">
  <span class="value"><b id="pwrval">1.0</b>√ó</span>
  <button class="tool" onclick="setPower(pwr.value)">Apply</button>
</div>

<div class="card">
  <h3>Solenoid Test</h3>
  <button class="test" onclick="fetch('/kick?v=0')">Tr·ªëng 1</button>
  <button class="test" onclick="fetch('/kick?v=1')">M√µ</button>
  <button class="test" onclick="fetch('/kick?v=2')">K·∫ªng</button>
  <button class="test" onclick="fetch('/kick?v=3')">Ch·ªßm Ch·ªçe</button>
  <button class="test" onclick="fetch('/kick?v=4')">Tr·ªëng 2</button>
  <button class="test" onclick="fetch('/kick_all')">ALL</button>
</div>

<div class="card">
  <h3>Flute Test</h3>
  <button class="test btn" onclick="fl(72)">Do</button>
  <button class="test btn" onclick="fl(74)">Re</button>
  <button class="test btn" onclick="fl(76)">Mi</button>
  <button class="test btn" onclick="fl(77)">Fa</button>
  <button class="test btn" onclick="fl(79)">Sol</button>
  <button class="test btn" onclick="fl(81)">La</button>
  <button class="test btn" onclick="fl(83)">Si</button>
</div>

<script>
async function loadPower(){
  try{
    const r=await fetch('/getpower');
    const x=parseFloat(await r.text());
    pwr.value=isNaN(x)?1.0:x;
    pwrval.textContent=pwr.value;
  }catch(e){}
}
async function setPower(x){
  try{await fetch('/power?x='+x);}catch(e){}
}
async function fl(n){
  try{await fetch('/flute_note?n='+n);}catch(e){}
}

loadPower();
</script>

</body>
</html>
